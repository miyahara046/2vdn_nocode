<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:_2vdm_spec_generator.ViewModel"
             x:Class="_2vdm_spec_generator.NoCodePage"
             x:DataType="vm:NoCodePageViewModel"
             Title="NoCode">

    <!-- メニューバー -->
    <ContentPage.MenuBarItems>
        <MenuBarItem Text="ファイル">
            <MenuFlyoutItem Text="フォルダを選択" Command="{Binding SelectFolderCommand}"/>
            <MenuFlyoutItem Text="新規ファイル作成" Command="{Binding CreateNewMdFileCommand}"/>
        </MenuBarItem>
        <MenuBarItem Text="変換">
            <MenuFlyoutItem Text="VDM++に変換" Command="{Binding ConvertToVdmCommand}"/>
            <MenuFlyoutItem Text="保存" Command="{Binding SaveMarkdownCommand}"/>
        </MenuBarItem>
    </ContentPage.MenuBarItems>

    <Grid RowDefinitions="Auto,*"
          ColumnDefinitions="1*,2*,2*">

        <!-- 上部操作ボタン -->
        <ScrollView Grid.Row="0" Grid.ColumnSpan="3" Orientation="Horizontal" Padding="10">
            <HorizontalStackLayout Spacing="15">
                <Button Text="スタートページに戻る" Command="{Binding GoToStartPageCommand}" />
                <Button Text="フォルダの選択" Command="{Binding SelectFolderCommand}" IsVisible="{Binding IsFolderSelected}" /> 
                <Button Text="クラスの種類選択・追加" Command="{Binding AddClassHeadingCommand}" IsVisible="{Binding IsClassAddButtonVisible}"/>
                <Button Text="画面の追加" Command="{Binding AddScreenListCommand}" IsVisible="{Binding IsScreenListAddButtonVisible}"/>

            </HorizontalStackLayout>
        </ScrollView>

        <!-- 左側：ファイル一覧 -->
        <Border Grid.Row="1" Grid.Column="0" Stroke="Gray" StrokeThickness="1" Padding="5" Margin="5">
            <VerticalStackLayout>
                <Label Text="ファイル一覧" FontAttributes="Bold" Margin="0,0,0,5"/>
                <CollectionView ItemsSource="{Binding FolderItems}"
                                SelectionMode="Single"
                                SelectedItem="{Binding SelectedFileName, Mode=TwoWay}">
                    <CollectionView.ItemTemplate>
                        <DataTemplate x:DataType="x:String">
                            <Label Text="{Binding}" Padding="5"/>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </VerticalStackLayout>
        </Border>

        <!-- 中央：Markdown 編集 -->
        <Border Grid.Row="1" Grid.Column="1" Stroke="Gray" StrokeThickness="1" Padding="10" Margin="5">
            <VerticalStackLayout>
                <Label Text="Markdown" FontSize="16" FontAttributes="Bold" Margin="0,0,0,5"/>
                <Editor Text="{Binding MarkdownContent}" 
                        AutoSize="TextChanges" 
                        HeightRequest="500"/>
            </VerticalStackLayout>
        </Border>

        <!-- 右側：VDM++ 表示 -->
        <Border Grid.Row="1" Grid.Column="2" Stroke="Gray" StrokeThickness="1" Padding="10" Margin="5">
            <VerticalStackLayout>
                <Label Text="VDM++" FontSize="16" FontAttributes="Bold" Margin="0,0,0,5"/>
                <Editor Text="{Binding VdmContent}" 
                        AutoSize="TextChanges" 
                        HeightRequest="500" 
                        IsReadOnly="True"/>
            </VerticalStackLayout>
        </Border>

    </Grid>
</ContentPage>
